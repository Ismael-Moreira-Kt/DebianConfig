#!/bin/bash



function choose_sound_configuration_en() {
    local CHOICE=-1

    while true; do
        clear

        echo "Choose an option to configure sound and audio:"
        echo "1. Adjust volume"
        echo "2. Adjust audio balance"
        echo "3. Set input device"
        echo "4. Set output device"
        echo "5. Configure audio profile"
        echo "6. Install audio tools"
        echo "7. Show audio system information"
        echo "8. Audio system diagnostics"
        echo "9. List Packages"
        echo "10. Return to main menu"

        read -p "Your choice (1-10): " CHOICE

        case $CHOICE in
            1) adjust_volume ;;
            2) adjust_balance ;;
            3) set_input_device ;;
            4) set_output_device ;;
            5) configure_audio_profile ;;
            6) install_audio_tools ;;
            7) show_audio_info ;;
            8) diagnose_audio_system ;;
            9) describe_audio_packages ;;
            10) break ;;
            *) echo "Invalid option. Please try again." ;;
        esac
    done
}



function adjust_volume() {
    echo "Adjust volume..."
    
    amixer -D pulse sset Master 80%
    
    echo "Volume adjusted successfully!"
}



function adjust_balance() {
    echo "Adjust audio balance..."

    amixer -D pulse sset Master 50%,50%
    
    echo "Audio balance adjusted successfully!"
}



function set_input_device() {
    echo "Setting the default input device..."
    default_input=$(pactl list sources short | grep -m 1 RUNNING | awk '{print $1}')
    
    if [ -z "$default_input" ]; then
        echo "No active input devices found, using the first available one."
        default_input=$(pactl list sources short | awk '{print $1}' | head -n 1)
    fi
    
    pactl set-default-source "$default_input"
    
    echo "Input device set to $default_input."
}



function set_output_device() {
    echo "Setting the default output device..."
    default_output=$(pactl list sinks short | grep -m 1 RUNNING | awk '{print $1}')
    
    if [ -z "$default_output" ]; then
        echo "No active output devices found, using the first available one."
        default_output=$(pactl list sinks short | awk '{print $1}' | head -n 1)
    fi
    
    pactl set-default-sink "$default_output"
    
    echo "Output device set to $default_output."
}



function configure_audio_profile() {
    echo "Configuring the default audio profile..."
    
    default_card=$(pactl list cards short | awk '{print $1}' | head -n 1)
    default_profile=$(pactl list cards | grep -A 20 "Card #$default_card" | grep 'output:' | awk '{print $1}' | head -n 1)
    
    pactl set-card-profile "$default_card" "$default_profile"
    
    echo "Audio profile $default_profile configured for sound card $default_card."
}



function install_audio_tools() {
    echo "Installing audio tools (ALSA and PulseAudio)..."

    sudo apt update -y
    sudo apt install -y alsa-utils pavucontrol pulseaudio
}



function diagnose_audio_system() {
    echo "Displaying detailed information about the audio system..."   
    echo
    echo "1. Input devices (microphones):"
    
    pactl list short sources
    
    echo
    echo "2. Output devices (speakers/headphones):"
    
    pactl list short sinks
    
    echo
    echo "3. Active audio profiles:"
    
    pactl list cards | grep -A 20 "Card #" | grep 'active profile'
    
    echo
    echo "4. PulseAudio status:"
    
    systemctl --user status pulseaudio | grep Active
    
    echo
    echo "5. ALSA control volume levels:"
    
    amixer scontents

    echo
    echo "Audio information displayed successfully."
}



function show_audio_info() {
    echo "Performing audio system diagnostics..."
    echo "PulseAudio status:"

    systemctl --user status pulseaudio | grep Active
    
    echo
    echo "ALSA audio devices:"
    
    aplay -l
    
    echo
    echo "Volume levels of ALSA controls:"
    
    amixer scontents
    
    echo
    echo "Diagnostics completed. Check the above results for possible problems."
}



function describe_audio_packages() {
    clear

    echo "Packages used for audio configuration:"
    echo
    echo "1. PulseAudio:"
    echo " - pulseaudio: Sound server that manages audio devices on the system."
    echo " - pulseaudio-utils: Set of utilities for controlling and configuring PulseAudio."
    echo
    echo "2. ALSA (Advanced Linux Sound Architecture):"
    echo " - alsa-utils: Set of utilities for controlling ALSA sound devices."
    echo " - alsa-oss: OSS emulator for ALSA devices."
    echo
    echo "3. Additional Drivers and Utilities:"
    echo " - pavucontrol: Graphical interface for controlling audio devices with PulseAudio."
    echo " - pasystray: Tray icon for quick control of PulseAudio."
    echo " - gnome-alsamixer: Graphical interface for controlling ALSA audio devices."
    echo
    echo "4. Sound Quality Enhancement Packages:"
    echo " - ladspa-sdk: Set of plugins for audio processing."
    echo " - pulseaudio-equalizer: Graphical equalizer for adjusting audio frequencies in PulseAudio."
    echo
    echo "Press 'q' to continue..."

    while true; do
        read -rsn1 input

        if [[ $input == 'q' ]]; then
            break
        fi
    done

    choose_sound_configuration_en
}