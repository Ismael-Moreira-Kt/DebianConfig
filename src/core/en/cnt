#!/bin/bash



function configure_network_en() {
    local CHOICE=-1

    while true; do
        clear

        echo "Choose an option to configure the network:"
        echo "1. Configure Network Interface"
        echo "2. Set Static IP Address"
        echo "3. Enable DHCP"
        echo "4. Configure DNS Servers"
        echo "5. Show Network Status"
        echo "6. Restart Network Services"
        echo "7. Return to Main Menu"

        read -p "Your choice (1-7): " CHOICE

        case $CHOICE in
            1) configure_network_interface ;;
            2) set_static_ip ;;
            3) enable_dhcp ;;
            4) configure_dns ;;
            5) show_network_status ;;
            6) restart_network_services ;;
            7) break ;;
            *) echo "Invalid option. Please try again." ;;
        esac
    done
}



function configure_network_interface() {
    echo "Configuring network interface..."

    echo "Available network interfaces:"
    ip link show | awk -F: '$1 !~ "lo|vir|wl|^[^0-9]" {print $2}'

    read -p "Enter the interface to configure (e.g., eth0): " INTERFACE

    if ip link show "$INTERFACE" &> /dev/null; then
        read -p "Do you want to enable or disable this interface? (enable/disable): " ACTION

        if [ "$ACTION" == "enable" ]; then
            sudo ip link set "$INTERFACE" up
            echo "Interface $INTERFACE enabled."
        elif [ "$ACTION" == "disable" ]; then
            sudo ip link set "$INTERFACE" down
            echo "Interface $INTERFACE disabled."
        else
            echo "Invalid action. Please try again."
        fi
    else
        echo "Interface $INTERFACE does not exist. Please try again."
    fi
}



function set_static_ip() {
    echo "Setting up network configuration..."

    while true; do
        echo "Available network interfaces:"
        ip link show | awk -F: '$1 !~ "lo|vir|wl|^[^0-9]" {print $2}'
        
        read -p "Enter the network interface you want to configure (e.g., eth0): " INTERFACE
        if ip link show "$INTERFACE" &> /dev/null; then
            break
        else
            echo "Invalid interface. Please try again."
        fi
    done

    echo "Would you like to configure a static IP address or use DHCP?"
    echo "1. Static IP Address"
    echo "2. Use DHCP (Automatic configuration)"

    read -p "Your choice (1-2): " IP_CHOICE

    if [ "$IP_CHOICE" == "1" ]; then
        echo "You've chosen to configure a static IP address."
        
        DEFAULT_IP="192.168.1.100"
        DEFAULT_NETMASK="255.255.255.0"
        DEFAULT_GATEWAY="192.168.1.1"
        DEFAULT_DNS="8.8.8.8"

        read -p "Enter the static IP address [default: $DEFAULT_IP]: " IP_ADDRESS
        IP_ADDRESS=${IP_ADDRESS:-$DEFAULT_IP}

        read -p "Enter the netmask [default: $DEFAULT_NETMASK]: " NETMASK
        NETMASK=${NETMASK:-$DEFAULT_NETMASK}

        read -p "Enter the gateway [default: $DEFAULT_GATEWAY]: " GATEWAY
        GATEWAY=${GATEWAY:-$DEFAULT_GATEWAY}

        read -p "Enter the DNS server [default: $DEFAULT_DNS]: " DNS
        DNS=${DNS:-$DEFAULT_DNS}

        sudo ip addr add "$IP_ADDRESS/$NETMASK" dev "$INTERFACE"
        sudo ip route add default via "$GATEWAY"
        echo "nameserver $DNS" | sudo tee /etc/resolv.conf > /dev/null

        echo "Static IP configuration applied to $INTERFACE."
    else
        echo "You've chosen to use DHCP."

        sudo ip addr flush dev "$INTERFACE"
        sudo ip route flush dev "$INTERFACE"

        sudo dhclient "$INTERFACE"

        echo "DHCP configuration applied to $INTERFACE."
    fi
}